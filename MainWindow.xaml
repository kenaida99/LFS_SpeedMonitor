<Window x:Class="MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:local="clr-namespace:LFS_SpeedMonitor"
        mc:Ignorable="d"
        Title="LFS Speed Monitor" Height="600" Width="800"
        AllowsTransparency="True"
        WindowStyle="None"
        Background="Transparent"
        Topmost="True"
        WindowState="Maximized"
        ShowInTaskbar="True">
    <Canvas x:Name="mainCanvas" Background="#01000000" Opacity="50">
        <!-- Finished Edits Button - shown only in edit mode -->
        <Button x:Name="btnFinishedEdits" 
                Content="✓ Finished Edits" 
                Canvas.Left="0" Canvas.Top="0"
                Width="200" Height="40"
                FontSize="16" FontWeight="Bold"
                Background="#FF00AA00" Foreground="White"
                BorderThickness="0"
                Visibility="Collapsed"
                Click="btnFinishedEdits_Click"
                Cursor="Hand">
            <Button.Style>
                <Style TargetType="Button">
                    <Setter Property="Template">
                        <Setter.Value>
                            <ControlTemplate TargetType="Button">
                                <Border Background="{TemplateBinding Background}" CornerRadius="0,0,5,0">
                                    <ContentPresenter HorizontalAlignment="Center" VerticalAlignment="Center"/>
                                </Border>
                            </ControlTemplate>
                        </Setter.Value>
                    </Setter>
                </Style>
            </Button.Style>
        </Button>

        <!-- Time Difference Gauge -->
        <GroupBox x:Name="timeGroupBox" Canvas.Left="50" Canvas.Top="50" Foreground="White" Background="Transparent" BorderBrush="Gray" BorderThickness="1"
                  HorizontalContentAlignment="Center" Cursor="SizeAll"
                  MouseLeftButtonDown="GroupBox_MouseLeftButtonDown"
                  MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"
                  MouseMove="GroupBox_MouseMove">
            <GroupBox.HeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="Time Difference (ms)" HorizontalAlignment="Center" Foreground="White"/>
                </DataTemplate>
            </GroupBox.HeaderTemplate>
            <local:DifferenceGaugeControl x:Name="timeGauge" StepSize="0.2" ValueFormat="F2" PositiveIsGood="False"/>
        </GroupBox>

        <!-- Speed Difference Gauge -->
        <GroupBox x:Name="speedGroupBox" Canvas.Left="50" Canvas.Top="150" Foreground="White" Background="Transparent" BorderBrush="Gray" BorderThickness="1"
                  HorizontalContentAlignment="Center" Cursor="SizeAll"
                  MouseLeftButtonDown="GroupBox_MouseLeftButtonDown"
                  MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"
                  MouseMove="GroupBox_MouseMove">
            <GroupBox.HeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="Speed Difference (km/h)" HorizontalAlignment="Center" Foreground="White"/>
                </DataTemplate>
            </GroupBox.HeaderTemplate>
            <local:DifferenceGaugeControl x:Name="speedGauge" StepSize="2.0" ValueFormat="F1" PositiveIsGood="True"/>
        </GroupBox>
        <!-- Radar Overlay -->
        <GroupBox x:Name="radarGroupBox" Canvas.Left="200" Canvas.Top="68" Width="400" Foreground="White" Background="Transparent" BorderBrush="Gray" BorderThickness="0"
              HorizontalContentAlignment="Center" Cursor="SizeAll"
              MouseLeftButtonDown="GroupBox_MouseLeftButtonDown"
              MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"
              MouseMove="GroupBox_MouseMove" HorizontalAlignment="Center" VerticalAlignment="Top">
            <GroupBox.HeaderTemplate>
                <DataTemplate>
                    <TextBlock Text="" HorizontalAlignment="Center" Foreground="White"/>
                </DataTemplate>
            </GroupBox.HeaderTemplate>
            <local:RadarControl x:Name="proximityRadar" MaxRange="25" Width="400" Height="400" Opacity="50"/>
        </GroupBox>
        <!-- Current Info -->
        <Border x:Name="infoBorder" Canvas.Left="50" Canvas.Top="250" Background="Transparent" CornerRadius="3" Padding="5" BorderBrush="Gray" BorderThickness="1"
                Cursor="SizeAll"
                MouseLeftButtonDown="GroupBox_MouseLeftButtonDown"
                MouseLeftButtonUp="GroupBox_MouseLeftButtonUp"
                MouseMove="GroupBox_MouseMove" Visibility="Hidden">
            <StackPanel Orientation="Horizontal" HorizontalAlignment="Center" >
                <TextBlock Text="Node: " Foreground="Gray"/>
                <TextBlock x:Name="txtCurrentNode" Text="0" Foreground="White" Margin="0,0,20,0"/>
                <TextBlock Text="Lap: " Foreground="Gray"/>
                <TextBlock x:Name="txtCurrentLap" Text="0" Foreground="White" Margin="0,0,20,0"/>
                <TextBlock Text="Speed: " Foreground="Gray"/>
                <TextBlock x:Name="txtCurrentSpeed" Text="0 km/h" Foreground="White"/>
            </StackPanel>

        </Border>
    </Canvas>
</Window>